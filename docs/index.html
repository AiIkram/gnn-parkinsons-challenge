<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNN Parkinson's Challenge - Leaderboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .leaderboard-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .filter-section {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }

        .filter-btn {
            padding: 12px 24px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #667eea;
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        th:hover {
            background: rgba(255,255,255,0.1);
        }

        th::after {
            content: ' ‚áÖ';
            opacity: 0.5;
            font-size: 0.8em;
        }

        th.sorted-asc::after {
            content: ' ‚ñ≤';
            opacity: 1;
        }

        th.sorted-desc::after {
            content: ' ‚ñº';
            opacity: 1;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tbody tr {
            transition: background-color 0.3s;
        }

        tbody tr:hover {
            background-color: #f5f5f5;
        }

        .rank {
            font-weight: bold;
            font-size: 1.2em;
        }

        .rank-1 { color: #FFD700; }
        .rank-2 { color: #C0C0C0; }
        .rank-3 { color: #CD7F32; }

        .medal {
            font-size: 1.5em;
            margin-right: 5px;
        }

        .score {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-new {
            background: #4CAF50;
            color: white;
        }

        .badge-top {
            background: #FF9800;
            color: white;
        }

        .code-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .code-link:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.2em;
        }

        .last-updated {
            text-align: center;
            margin-top: 20px;
            color: #999;
            font-size: 0.9em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            padding: 20px;
        }

        footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .stats {
                flex-direction: column;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 10px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß† GNN Parkinson's Challenge</h1>
            <p class="subtitle">Real-time Leaderboard - Detect Parkinson's Disease using Graph Neural Networks</p>
            
            <div class="stats">
                <div class="stat-box">
                    <span class="stat-number" id="total-submissions">0</span>
                    <span class="stat-label">Total Submissions</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number" id="top-score">0.0000</span>
                    <span class="stat-label">Top Score</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number" id="baseline-score">0.7654</span>
                    <span class="stat-label">Baseline</span>
                </div>
            </div>
        </header>

        <div class="leaderboard-container">
            <div class="filter-section">
                <input type="text" class="search-box" id="search" placeholder="üîç Search by username or model...">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="this-week">This Week</button>
                <button class="filter-btn" data-filter="this-month">This Month</button>
            </div>

            <table id="leaderboard-table">
                <thead>
                    <tr>
                        <th data-sort="rank">Rank</th>
                        <th data-sort="username">Username</th>
                        <th data-sort="score">F1-Score</th>
                        <th data-sort="model">Model</th>
                        <th data-sort="date">Date</th>
                        <th>Code</th>
                        <th>Progress</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                    <!-- Dynamically populated -->
                </tbody>
            </table>

            <div id="no-results" class="no-results" style="display: none;">
                No submissions found matching your criteria.
            </div>

            <div class="last-updated">
                Last updated: <span id="last-update"></span>
            </div>
        </div>

        <footer>
            <p>
                <a href="https://github.com/AiIkram/gnn-parkinsons-challenge" target="_blank">
                    üìÇ View on GitHub
                </a> | 
                <a href="https://github.com/AiIkram/gnn-parkinsons-challenge/blob/main/RULES.md" target="_blank">
                    üìã Rules
                </a> | 
                <a href="https://github.com/AiIkram/gnn-parkinsons-challenge/blob/main/FAQ.md" target="_blank">
                    ‚ùì FAQ
                </a>
            </p>
            <p style="margin-top: 10px; opacity: 0.8;">
                ¬© 2025 GNN Parkinson's Challenge | Created by Aissiou Ikram
            </p>
        </footer>
    </div>

    <script>
        // Fetch leaderboard data from JSON
        let submissions = [];

        async function fetchLeaderboardData() {
            try {
                const response = await fetch('leaderboard_data.json');
                const data = await response.json();
                submissions = data.submissions;
                document.getElementById('baseline-score').textContent = data.baseline_score.toFixed(4);
                updateStats();
                renderLeaderboard();
                updateLastUpdated();
            } catch (error) {
                console.error('Error fetching leaderboard data:', error);
                // Fall back to sample data
                submissions = [
                    {
                        rank: 1,
                        username: "baseline_gcn",
                        score: 0.7654,
                        model: "GCN",
                        date: "2025-01-15",
                        code: "submissions/baseline_gcn/",
                        isNew: false,
                        isTop: true
                    }
                ];
                renderLeaderboard();
            }
        }

        // Update init function
        function init() {
            fetchLeaderboardData();
            setupEventListeners();
        }

        // State
        let currentSort = { column: 'rank', direction: 'asc' };
        let currentFilter = 'all';
        let searchQuery = '';

        // Initialize
        function init() {
            updateStats();
            renderLeaderboard();
            updateLastUpdated();
            setupEventListeners();
        }

        // Update statistics
        function updateStats() {
            document.getElementById('total-submissions').textContent = submissions.length;
            document.getElementById('top-score').textContent = 
                submissions.length > 0 ? submissions[0].score.toFixed(4) : '0.0000';
        }

        // Render leaderboard
        function renderLeaderboard() {
            let filteredData = filterData();
            filteredData = sortData(filteredData);

            const tbody = document.getElementById('leaderboard-body');
            const noResults = document.getElementById('no-results');

            if (filteredData.length === 0) {
                tbody.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }

            noResults.style.display = 'none';

            tbody.innerHTML = filteredData.map((item, index) => {
                const actualRank = index + 1;
                const medal = actualRank === 1 ? 'ü•á' : actualRank === 2 ? 'ü•à' : actualRank === 3 ? 'ü•â' : '';
                const rankClass = `rank-${actualRank}`;
                const badges = [];
                
                if (item.isNew) badges.push('<span class="badge badge-new">NEW</span>');
                if (item.isTop && actualRank <= 3) badges.push('<span class="badge badge-top">TOP</span>');

                const progressPercent = (item.score / 1.0) * 100;

                return `
                    <tr>
                        <td class="rank ${actualRank <= 3 ? rankClass : ''}">
                            ${medal} ${actualRank}
                        </td>
                        <td>
                            <strong>${item.username}</strong>
                            ${badges.join(' ')}
                        </td>
                        <td class="score">${item.score.toFixed(4)}</td>
                        <td>${item.model}</td>
                        <td>${formatDate(item.date)}</td>
                        <td>
                            <a href="https://github.com/AiIkram/gnn-parkinsons-challenge/tree/main/${item.code}" 
                               class="code-link" target="_blank">
                                View Code ‚Üí
                            </a>
                        </td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Filter data
        function filterData() {
            let filtered = [...submissions];

            // Apply time filter
            if (currentFilter !== 'all') {
                const now = new Date();
                const filterDate = new Date();

                if (currentFilter === 'this-week') {
                    filterDate.setDate(now.getDate() - 7);
                } else if (currentFilter === 'this-month') {
                    filterDate.setMonth(now.getMonth() - 1);
                }

                filtered = filtered.filter(item => new Date(item.date) >= filterDate);
            }

            // Apply search filter
            if (searchQuery) {
                const query = searchQuery.toLowerCase();
                filtered = filtered.filter(item => 
                    item.username.toLowerCase().includes(query) ||
                    item.model.toLowerCase().includes(query)
                );
            }

            return filtered;
        }

        // Sort data
        function sortData(data) {
            return data.sort((a, b) => {
                let valA = a[currentSort.column];
                let valB = b[currentSort.column];

                if (currentSort.column === 'score' || currentSort.column === 'rank') {
                    valA = parseFloat(valA);
                    valB = parseFloat(valB);
                }

                if (currentSort.column === 'date') {
                    valA = new Date(valA);
                    valB = new Date(valB);
                }

                if (currentSort.direction === 'asc') {
                    return valA > valB ? 1 : -1;
                } else {
                    return valA < valB ? 1 : -1;
                }
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search
            document.getElementById('search').addEventListener('input', (e) => {
                searchQuery = e.target.value;
                renderLeaderboard();
            });

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    renderLeaderboard();
                });
            });

            // Sort headers
            document.querySelectorAll('th[data-sort]').forEach(th => {
                th.addEventListener('click', (e) => {
                    const column = e.target.dataset.sort;
                    
                    if (currentSort.column === column) {
                        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSort.column = column;
                        currentSort.direction = 'asc';
                    }

                    // Update visual indicators
                    document.querySelectorAll('th').forEach(t => {
                        t.classList.remove('sorted-asc', 'sorted-desc');
                    });
                    e.target.classList.add(`sorted-${currentSort.direction}`);

                    renderLeaderboard();
                });
            });
        }

        // Format date
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        // Update last updated time
        function updateLastUpdated() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleString();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);

        // Auto-refresh every 5 minutes
        setInterval(() => {
            // In production, fetch new data from GitHub API or JSON file
            updateLastUpdated();
        }, 300000);
    </script>
</body>
</html>